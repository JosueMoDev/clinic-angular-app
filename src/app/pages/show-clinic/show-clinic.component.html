<div  class="container mx-auto px-6 py-6">
  <div class="flex flex-wrap -mx-3">
    <form (submit)="updateProfile()" [formGroup]="profileForm" class="w-full max-w-full px-3 shrink-0 md:w-8/12 md:flex-0">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Edit Information for Clinic</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div>
            <div formGroupName="information" class="grid grid-cols-1 gap-4 md:grid-cols-3">
              <mat-form-field>
                <mat-label>Register Number</mat-label>
                <input matInput placeholder="Register Number" formControlName="registerNumber" mask="0000-0000-000-0">
                <mat-icon matSuffix *ngIf="!profileForm.get('information.registerNumber')?.invalid && profileForm.get('information.registerNumber')?.touched" color="accent">done</mat-icon>
              </mat-form-field>
              <mat-form-field>
                <mat-label>Phone</mat-label>
                <input matInput placeholder="Phone" formControlName="phone" prefix="(+503) " mask="0000-0000">
                <mat-icon matSuffix *ngIf="!profileForm.get('information.phone')?.invalid && profileForm.get('information.phone')?.touched" color="accent">done</mat-icon>
              </mat-form-field>
              <mat-form-field>
                <mat-label>Name</mat-label>
                <input matInput placeholder="Name" formControlName="name">
                <mat-icon matSuffix *ngIf="!profileForm.get('information.name')?.invalid && profileForm.get('information.name')?.touched" color="accent">done</mat-icon>
                <mat-error *ngIf="profileForm.get('information.name')?.errors?.['required']">Name is required.</mat-error>
                <mat-error *ngIf="profileForm.get('information.name')?.errors?.['minlength']">Name must be at least 3 characters long.</mat-error>
                <mat-error *ngIf="profileForm.get('information.name')?.errors?.['maxlength']">Name must be longer than 25 characters.</mat-error>
                <mat-error *ngIf="profileForm.get('information.name')?.errors?.['forbiddenName']">
                  <span>Name only could have letters a-z.</span>
                  <span>Only two names are allowed.</span>
                </mat-error>
              </mat-form-field>
            </div>
            <div formGroupName="address" class="grid grid-cols-1 gap-4 md:grid-cols-3">
              <mat-form-field>
                <mat-label>State</mat-label>
                <input matInput placeholder="State" formControlName="state">
                <mat-icon matSuffix *ngIf="!profileForm.get('address.state')?.invalid && profileForm.get('address.state')?.touched" color="accent">done</mat-icon>
              </mat-form-field>
              <mat-form-field>
                <mat-label>City</mat-label>
                <input matInput placeholder="City" formControlName="city">
                <mat-icon matSuffix *ngIf="!profileForm.get('address.city')?.invalid && profileForm.get('address.city')?.touched" color="accent">done</mat-icon>
              </mat-form-field>
              <mat-form-field>
                <mat-label>Street</mat-label>
                <input matInput placeholder="Street" formControlName="street">
                <mat-icon matSuffix *ngIf="!profileForm.get('address.street')?.invalid && profileForm.get('address.street')?.touched" color="accent">done</mat-icon>
              </mat-form-field>
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <button mat-raised-button type="submit" [disabled]="!(somethingChanged && (!profileForm.invalid || profileForm.pristine))" color="accent">
            <mat-icon>update</mat-icon>Update
          </button>
        </mat-card-actions>
      </mat-card>
    </form>
    <form [formGroup]="photoForm" 
      class="w-full max-w-full px-3 mt-6 shrink-0 md:w-4/12 md:flex-0 md:mt-0"
    
    >
      <mat-card>
        <div>
          <img *ngIf="!imagenTemp" [src]="currectPhoto || 'assets/img/no-photo-clinic.jpg'" alt="profile cover image">
          <img *ngIf="imagenTemp" [src]="imagenTemp">
        </div>
        <mat-card-content>
           <div class="flex justify-center py-3 space-x-3">
              <div class="flex w-fit">
                <button
                  mat-raised-button
                  type="button"
                  [disabled]="!currectPhoto"
                  (click)="deletePhoto(profileSelected.id)"
                  color="warn"
                >
                  <mat-icon>delete</mat-icon>
                  <span>Delete</span>
                </button>
              </div>
              <div
                *ngIf="
                  !this.photoForm.get('photoSrc')?.touched &&
                  this.photoForm.get('photoSrc')?.value
                "
                class="flex w-fit"
              >
                <button
                  mat-raised-button
                  type="submit"
                  [disabled]="isLoading"
                  color="accent"
                >
                  <mat-icon *ngIf="!isLoading">upload</mat-icon>
                  <mat-icon *ngIf="isLoading" class="animate-spin"
                    >autorenew</mat-icon
                  >
                  <span>Upload</span>
                </button>
              </div>
              <button mat-raised-button type="button" color="primary">
                <label for="photo">
                  <mat-icon>camera</mat-icon>
                  <span>New</span>
                </label>
                <input
                  id="photo"
                  accept="image/png, image/jpeg, image/jpg"
                  formControlName="photo"
                  type="file"
                  style="display: none"
                />
              </button>
            </div>
        </mat-card-content>
      </mat-card>
    </form>
  </div>
</div>

<div>
  <app-clinic-assignment></app-clinic-assignment>
</div>
